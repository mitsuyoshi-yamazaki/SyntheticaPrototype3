# コミットノート - 5d9a056ecc6c96a9a1c6bccf4ee7e19b2f6027ef

## ユーザープロンプト

```
先ほどの、エネルギー確保順序とアクション実行順序の草稿作成 は完了したか。未完了であれば進めよ
```

続いて：

```
よろしい。 game-world-requirement.md に、 energy-action-order.md への参照を追加せよ
```

続いて：

```
ルートディレクトリのCLAUDE.mdの ユーザー指示を受けてファイルを変更した場合 を実行せよ
```

## 実施内容

エネルギー確保順序とアクション実行順序の仕様文書を作成し、関連ファイルを更新しました。

### 1. energy-action-order.mdの作成

以下の内容を定義：

- **基本原則**
  - 処理順序：ユニットIDの大きい順（新しいユニット優先）
  - エネルギーソース：各tickの最初に処理
  - 適用範囲：競合が発生する可能性のあるアクションのみ
  - 設計思想：長生きの個体に不利になるように設計

- **tick処理フロー**
  - エネルギーソースによるエネルギー出現
  - 物理演算
  - 熱拡散
  - ユニットアクション実行（ID降順）
  - エネルギー消費処理
  - 状態更新

- **競合解決の実装**
  - エネルギー取得の競合
  - 空間配置の競合
  - その他の競合アクション

### 2. game-world-requirement.mdの更新

以下の2箇所のTODOをenergy-action-order.mdへの参照に変更：

- tick処理のユニットアクションフェーズ（112-113行目）
- エネルギー消費の統一フレームワーク（148行目）

### 3. TODO.mdの更新

「エネルギー確保順序とアクション実行順序を決定」タスクを完了に変更。