# コミット 67ca07d369a2c06e63bdea4e58d6ac2610806ef7

## ユーザープロンプト

```
src/game/agent/AgentActionResolver.ts のテストファイルを作成し、その中に resolveMove() のテストケースを作成せよ
その際、コンパイルエラーとlintエラーが発生したら解消し、また、 docs/coding-guidelines.md に記載された規約を満たすようにせよ
最後に yarn format を行え
```

その後、テスト実行で発見されたバグに対して：

```
修正せよ
```

## 実施内容

1. `src/game/agent/AgentActionResolver.test.ts` を作成
   - `resolveMove()` の包括的なテストケースを実装
   - エネルギーが十分な場合、不足する場合、境界値など6つのシナリオをカバー

2. テスト実行により `AgentActionResolver.ts` のバグを発見・修正
   - 条件分岐の論理エラー: `requiredEnergy >= agent.energyAmount` → `requiredEnergy <= agent.energyAmount`
   - ゼロベクトル処理エラー: ゼロベクトルの正規化を回避する処理を追加

3. コンパイルエラー、lintエラーの解消、フォーマット実行

## 発見されたバグの詳細

元の実装では「必要エネルギー >= 保有エネルギー」のときに要求された力をそのまま適用しようとしていたが、これはエネルギーが不足している状況であり、論理的に矛盾していた。条件を反転させることで正しい挙動に修正。

また、ゼロベクトルに対して `normalized` を呼び出すと例外が発生するため、ゼロベクトルの場合は正規化をスキップする処理を追加。
