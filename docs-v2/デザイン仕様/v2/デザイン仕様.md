## デザイン仕様 v2

### 目的

- いい感じのエージェントデザインを策定する

### 対象

- 本バージョンで指定するのはユニットの形状と大きさのみである
  - ユニットのカラーリングはv1を踏襲する
  - ユニット以外のデザインはv1を踏襲する

### 要件

- エージェントのユニット構成が見た目から判別できること
- それぞれのユニットの状態が見た目から判別できること
  - 各ユニットで見た目に表現したい状態
  - 共通
    - HULLへの固定状態（固定されている/固定されていない）
  - HULL
    - 容量
    - （optional）エネルギー格納割合
  - ASSEMBLER
    - assemble power
    - （optional）生産/修理中かどうか
  - COMPUTER
    - 処理速度、メモリ容量
- （優先度低）単細胞生物的な見た目になること

### 実現案

#### ① 細胞の模式図的

- 各ユニットの面積は、それぞれのゲーム世界上での容量に比例する
  - これにより、見た目の上でも容量の整合性がとれるようになる
  - 細かい整合性は無視する（例えば、見た目上は角丸のある長方形の面積は、角丸のない長方形の面積として扱って良い）
- 各ユニットは、ネイティブな見た目の他に、HULLに固定されている状態では異なる見た目をとる
- HULL
  - ネイティブなデザイン：
    - pill shape ※ で表現する
      - ※ 両端が半円になった長方形の形（円形も含む）
      - 容積がa以上のHULLは全て円形で表し、b以上のHULLは直線の長さが円部分の半径と同じpill shapeで表し、a以上b以下のHULLは円部分の半径を変えずに直線部分の長さを変えることで容積に合わせる
  - HULLに固定されている状態のデザイン：
    - HULLに外接している場合：
      - ネイティブなデザインで表現されたHULLふたつが接している状態
    - HULLに内接している場合
      - v3.1系のゲーム仕様では内接はできない
  - 備考
    - エネルギー格納割合は表現しない
- ASSEMBLER
  - ネイティブなデザイン：
    - 角丸長方形
  - HULLに固定されている状態のデザイン：
    - HULL固定のCOMPUTERが存在する場合：COMPUTERに重ならない、先端の欠けた扇形
    - COMPUTERが存在しない場合：扇形
  - 生産/修理中かどうか
    - 生産/修理中である場合は中心に明るい点を表示することで表現する
- COMPUTER
  - ネイティブなデザイン：
    - 円形
  - HULLに固定されている状態のデザイン：
    - HULLの中心に固定されたpill shape
    - HULLに複数のCOMPUTERが固定されている場合は、全てのCOMPUTERの容積を合計したpill shapeを描き、それをピザを切るように分割してそれぞれのCOMPUTERを表現する

### 実装方針

#### アニメーション

- tick間の中間状態を表現するアニメーションは実装しない
- 状態変化は即座に新しい見た目に切り替わる

#### 視覚専用データ

- ゲーム仕様には存在しない「見た目のための位置情報」をユニットの`visualData`プロパティとして保持する
- これによりtick間で見た目の位置を維持し、毎フレームの再計算を避ける
- 視覚専用データの例：
  - ASSEMBLER: HULL内での配置角度
  - COMPUTER: ピザカット分割での開始・終了角度
- HULLマージ時のみ視覚位置を再計算する

#### 容量パラメータ

- pill shape変化の閾値（a, b）は実装時に決定する
- ゲーム仕様の容量と見た目のサイズの対応は実装時に調整する

#### 面積計算

- 複数COMPUTERのピザカット分割は、見た目の面積がゲーム上の容積に比例していれば詳細な精度は不要
