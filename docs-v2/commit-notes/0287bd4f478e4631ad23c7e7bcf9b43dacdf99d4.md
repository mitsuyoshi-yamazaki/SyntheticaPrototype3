# コミットノート: 0287bd4f478e4631ad23c7e7bcf9b43dacdf99d4

## ユーザープロンプト

未実装機能のうち、実装するうえで仕様を定める必要のあるものはあるか
→ 仕様を確定（BLT/BGE/BNE: 直前の比較結果、符号なし比較）
→ コミットしたのち進めよ

## 実行内容

自己複製コード実行に必要な分岐命令群の実装：

### 仕様確定内容
1. **BLT/BGE/BNE**: 直前の比較結果に基づく、符号なし比較
2. **UNIT_MEM_WRITE_DYN**: 失敗時もエネルギー消費、副作用なし
3. **CMOV系**: 3E消費、1サイクル実行（条件成立・不成立共通）

### 実装内容

#### 新規命令追加
- **JUL (0x6A)**: 符号なし小なり（BLT相当）
  - キャリーフラグがセットかつゼロフラグがクリア
- **JUGE (0x6B)**: 符号なし以上（BGE相当）
  - キャリーフラグがクリアまたはゼロフラグがセット

#### 既存命令の実行ロジック実装
- **JGE/JL/JLE/JG**: 符号付き比較ジャンプ命令群
  - フラグベースの条件判定ロジック実装

#### 変更ファイル
- `vm-instructions.ts`: JUL/JUGE命令定義追加
- `vm-executor.ts`: 全分岐命令の実行ロジック実装
- `vm-decoder.ts`: 新命令のオペランドデコード対応
- テストファイル: 新命令のテストケース追加

### テスト結果
- vm-executor.test.ts: 41/41テスト成功
- vm-decoder.test.ts: 29/29テスト成功

### 自己複製コードとの対応
- `BGE reproduction_phase` → `JUGE reproduction_phase` (0x6B)
- `BLT wait_energy` → `JUL wait_energy` (0x6A)
- `BNE wait_expansion` → `JNZ wait_expansion` (0x62、既存命令)

### 技術的詳細
- CMP_AB命令でフラグを設定
- 符号なし比較はキャリーフラグで判定
- 符号付き比較は符号付き演算結果を考慮
- 3バイト命令、符号付き16bitオフセット使用