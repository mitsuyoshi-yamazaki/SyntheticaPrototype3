# コミットノート - f098de7f488821de1ad86d79cd17b19cf3f6f0c7

## ユーザープロンプト

```
TODO.md の エネルギーオブジェクトの物理仕様 について実施する

基本的にTODO.mdに書いてある通りだが、
- v3系の仕様ではDISASSEMBLERがないため、基本的には分割されない
- HULLがエネルギー回収状態でエネルギーオブジェクトと隣接しているが、そのオブジェクトのエネルギー全体を格納できるHULL容量がない場合は、HULLに格納された分のエネルギーがエネルギーオブジェクトから減る
- HULL内に格納されたエネルギーオブジェクトはすべて相互の相対速度が0となるので、オブジェクト的に合成される

他に決定すべき内容があれば教えよ
```

続いて、追加で決定すべき内容への回答：

```
1. エネルギーオブジェクトのサイズ計算
-> エネルギー量がオブジェクトの面積に比例するようにせよ。比例係数は仮で定めておけ

2. 最小・最大サイズ制限
-> 仕様上、1E未満や端数のあるエネルギーは存在しない。エネルギーオブジェクトの最小、最大エネルギー量の設定はない

3. エネルギー結合の詳細
-> 結合時の位置は計算が簡単なもの（例：2オブジェクトの中間点など）で良い
エネルギー結合はオブジェクトをひとつひとつ処理するため、3つ以上のオブジェクトの結合はない（2つが結合→残った一つと結合 となる）

4. 部分回収時の挙動
-> あるエネルギーオブジェクトからエネルギーが一部回収された場合、単にその位置で、エネルギーが減った分サイズが小さくなる

5. 初期速度
-> 一旦初期速度は0で良い

6. 可視化
-> 実装時に他のオブジェクトと一括で決定する
```

続いて：

```
よろしい。 game-world-requirement.md に関連項目があれば更新し、また energy-object-physics.md への参照を追加せよ
```

続いて：

```
ルートディレクトリのCLAUDE.mdの ユーザー指示を受けてファイルを変更した場合 を実行せよ
```

## 実施内容

エネルギーオブジェクトの物理仕様を定義し、関連ファイルを更新しました。

### 1. energy-object-physics.mdの作成

以下の仕様を定義：

- **サイズ計算**
  - エネルギー量が面積に比例：`radius = sqrt(energy/π)`
  - 比例係数は調整可能（初期値1.0）

- **エネルギー結合**
  - 結合条件：隣接かつ相対速度10以下
  - 結合位置：2オブジェクトの中間点
  - 運動量保存則に従う
  - 2オブジェクトずつ処理（3つ以上の同時結合なし）

- **HULLによる回収**
  - 完全回収：全体を格納
  - 部分回収：容量分だけ回収、残りは元の位置でサイズ縮小
  - HULL内では即座に統合（相対速度0のため）

- **物理特性**
  - 質量 = エネルギー量
  - 初期速度0
  - 通常のゲームオブジェクトと同じ物理法則
  - 円形（他のオブジェクトと同様）

- **制約**
  - 最小1E（整数のみ）
  - 最大値なし
  - v3ではDISASSEMBLERなし（分割されない）

### 2. game-world-requirement.mdの更新

以下の箇所にenergy-object-physics.mdへの参照を追加：

- エネルギー[Energy]セクション（193行目）：物理的挙動への参照
- HULLの回収/放出仕様（271行目）：部分回収の仕様と参照

### 3. TODO.mdの更新

- 「エネルギーオブジェクトの物理仕様」タスクを完了に変更
- 詳細説明を実装内容に更新
