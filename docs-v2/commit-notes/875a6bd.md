# コミット 875a6bd の指示内容

## ユーザーからの指示

ファイル冒頭のテスト内容を更新した。追記した通り、すべてのテストケースで InstructionExecutor.step() の **実行前後** の、VMのPC, 各レジスタおよびすべてのフラグの内容 を確認する実装を行え

## 実施内容

VM命令テストにおいて、InstructionExecutor.step()の実行前後でVMの全状態を検証するようにテストを更新しました。

### 実装内容

1. **ヘルパー関数の追加**
   - `expectVMState()` ヘルパー関数を追加
   - VM状態の包括的な検証を一度に行える
   - 検証項目：PC、SP、全レジスタ（A、B、C、D）、carryFlag、zeroFlag

2. **テストの変換**
   - MOV_BA、MOV_DA命令のテストを新パターンに変換
   - 実行前後の全VM状態を検証するよう更新
   - 既存の5つのテスト（NOP0、NOP1、XCHG、MOV_AB、MOV_AD）は既に変換済み

3. **今後の作業**
   - 残りの全てのVM命令テストに同様のパターンを適用予定
   - 現在62個のテストがパス、50個が失敗（VM実装の問題）