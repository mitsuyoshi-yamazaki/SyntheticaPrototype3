# コミット 56b901b の指示内容

## ユーザーからの指示

よろしい
この調子で、他の命令のテストも実装せよ

ファイル冒頭のコメントにも記載したが、以下の2点に留意せよ

- 実装不備を洗い出すことが目的なので、 **テストが通る必要はない。** 仕様上必要とされるテスト内容を実装する
- ユニット操作に関する命令などのように、VM以外への副作用を持つ命令については、後に実装するため、コメントでテストのプレースホルダを記述するのみとする

## 実施内容

仕様書（docs/spec-v3/synthetica-script.md）に基づいて、VM命令の包括的なテストスイートを実装しました。

### 実装したテスト

1. **データ移動命令**
   - MOV_AB, MOV_AD: レジスタ間のコピー
   - MOV_SP, SET_SP: スタックポインタの読み書き

2. **算術演算命令**
   - INC_A, DEC_A: インクリメント/デクリメント（オーバーフロー/アンダーフローのテスト含む）
   - ADD_AB, SUB_AB: 加算/減算（キャリー/ボローフラグのテスト含む）
   - XOR_AB: XOR演算（ゼロフラグのテスト含む）
   - CMP_AB: 比較（A > B, A < B, A == Bの各ケース）

3. **スタック操作**
   - PUSH_A: 16bit値のプッシュ（リトルエンディアン格納の確認）
   - POP_A: 16bit値のポップ（値の復元確認）

4. **メモリアクセス命令**
   - LOAD_A, STORE_A: 相対アドレスでの8bit読み書き（負のオフセット含む）
   - LOAD_A_W: 16bit値の読み込み（リトルエンディアン）
   - LOAD_ABS: 絶対アドレスからの読み込み（高コスト6サイクル）

5. **制御命令**
   - JMP: 前方/後方ジャンプ
   - JZ: 条件ジャンプ（フラグによる分岐）
   - CALL: サブルーチン呼び出し（戻り先保存）
   - JMP_ABS: 絶対アドレスへのジャンプ
   - RET: Cレジスタからの復帰

6. **拡張演算命令**
   - MUL_AB: 16bit乗算（オーバーフロー処理含む）
   - DIV_AB: 除算とモジュロ（ゼロ除算エラー含む）
   - LOAD_IMM: 16bit即値ロード（リトルエンディアン）

### プレースホルダとして記述した命令

VM以外への副作用を持つ以下の命令は、test.todo()でプレースホルダを記述：

- **ユニット操作命令**: UNIT_MEM_READ, UNIT_MEM_WRITE等
- **エネルギー計算命令**: ADD_E32, SUB_E32等（1024進法演算）
- **パターンマッチング命令**: SEARCH_F, SEARCH_B等（テンプレートマッチング）

実装不備の洗い出しを目的としているため、テストが通ることを前提とせず、仕様書に基づいた厳密なテストケースを作成しました。
