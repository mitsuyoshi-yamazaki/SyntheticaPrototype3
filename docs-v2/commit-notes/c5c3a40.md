# c5c3a40 のコミットノート

## ユーザープロンプト

docs/spec-v3/synthetica-script.md に仕様を記載した命令セットの各命令のテストを src/engine/vm-instructions.test.ts に記載している（このファイルは行数が多いため、読み込む際はルートレベルにあるそれぞれの命令の describe() （ `describe("0xc8 CMOV_NC"` など）で検索して読み込むようにせよ）に記載している。

命令セットのテストは src/engine/vm-arithmetic.test.ts にも記述があるので、vm-instructions.test.ts へ統合したい
vm-instructions.test.ts に記載のない条件のテストケースがあれば、 vm-instructions.test.ts へ追加せよ。また、追加する際は vm-instructions.test.ts 冒頭のコメント（ `/*〜*/` ）に記載のテスト実装方法に従って書き直せ

実装の変更はせず、命令の仕様は仕様書のみを確認せよ。 vm-arithmetic.test.ts に記載のテストは、 **仕様に沿っていない場合がある** 点に留意せよ。質問があれば私に聞け

## 実施内容

1. vm-arithmetic.test.tsとvm-instructions.test.tsの内容を比較分析
2. 仕様書を確認し、各命令の正確な仕様を把握
3. SHL/SHR命令が仕様書では「Bレジスタの下位4bitの値だけシフト（0-15bit）」と定義されていることを確認
4. vm-instructions.test.tsに追加すべきテストケースを特定
5. 以下のテストケースをvm-instructions.test.tsに追加：
   - SHL命令: 0ビットシフト、15ビットシフト（最大値）、下位4ビット制限、ゼロフラグセット
   - SHR命令: 0ビットシフト、15ビットシフト（最大値）、下位4ビット制限、符号なし右シフト、ゼロフラグセット
6. vm-arithmetic.test.tsから統合済みテストを削除（コメントのみ残す）

注：vm-arithmetic.test.tsにあった「下位5ビット」のテストは仕様に沿っていないため除外