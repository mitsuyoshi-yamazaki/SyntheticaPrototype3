# Synthetica仕様バージョン管理

## 現在のバージョン: 3.1.0

リリース日: 2025-07-31

## バージョン3.1.0の主要な変更点

### 機能追加（MINOR）

1. **プリミティブ命令の追加**
   - ビットシフト命令（SHL, SHR, SAR）
   - スタック操作命令（PUSH_A/B/C/D, POP_A/B/C/D, MOV_SP, SET_SP）
   - 条件付き実行命令（CMOV_Z, CMOV_NZ, CMOV_C, CMOV_NC）
   - 動的ユニット操作命令（UNIT_MEM_WRITE_DYN）

2. **スタック管理機能**
   - スタックポインタ（SP）の導入
   - PUSH/POP命令によるスタック操作のサポート
   - メモリ管理のベストプラクティス文書化

### 後方互換性

すべての変更は後方互換性を維持しています。v3.0.0のプログラムはv3.1.0でも動作します。

## バージョン3.0.0の主要な変更点

### 破壊的変更（MAJOR）

1. **1024進法エネルギーシステムの採用**
   - エネルギー表現を32bit（上位16bit: 1024E単位、下位16bit: 1E単位）に変更
   - すべてのエネルギー値を整数化（小数廃止）
   - エネルギーコストを全体的に1/10に削減

2. **16bitアーキテクチャへの移行**
   - プログラムカウンタ、レジスタ、メモリアドレスすべて16bit化
   - 最大メモリ容量: 65,536バイト（64KB）
   - ユニット操作の16bit対応

### 機能追加（MINOR相当）

1. **新命令の追加**
   - レジスタベース・間接アドレッシング命令
   - UNIT_EXISTS命令（ユニット存在確認）
   - エネルギー計算専用命令（ADD_E32, SUB_E32, CMP_E32, SHR_E10, SHL_E10）

2. **ユニットメモリマップの拡充**
   - 各ユニット種別の完全なメモリマップ定義
   - 動的ユニット指定のサポート

### バグ修正（PATCH相当）

1. **仕様の明確化**
   - tick処理順序の定義
   - エネルギー消費タイミングの明確化
   - ユニット生成仕様の詳細化

## バージョン2.x.xからの移行ガイド

### エネルギー値の変換

- 旧: 小数を含むエネルギー値（例: 0.1E）
- 新: すべて整数化（例: 1E）
- コスト削減: ほとんどの値が1/10になっています

### アーキテクチャの変更

- 旧: 8bitアーキテクチャ
- 新: 16bitアーキテクチャ
- メモリアドレス、レジスタ値の範囲が拡大

### 命令セットの拡張

- 既存の命令はすべて互換性を維持
- 新規命令はオペコード0x50-0x53, 0x94-0x99に追加

## 関連ファイル

### 主要仕様書

- `game-world-requirement.md` - ゲーム世界全体の仕様
- `synthetica-script.md` - Synthetica Script言語仕様

### エネルギーシステム

- `energy-definition.md` - エネルギー単位の定義
- `energy-consumption.md` - エネルギー消費の詳細
- `energy-constants.h` - エネルギー関連定数
- `energy-balance-verification.md` - バランス検証結果

### 実装例

- `agent-code/example.c` - 自己複製エージェントのC言語実装
- `agent-code/example_compiled_16bit.md` - 16bitアセンブリへのコンパイル結果

## 今後の予定

### バージョン3.2.0（予定）

- エネルギーソースの実装
- 熱拡散システムの詳細定義
- 移動システムの実装

### バージョン4.0.0（予定）

- 新ユニットタイプの追加
- 物理演算システムの拡張
