# SyntheticaPrototype2 v3仕様改善提案

## 作成日: 2025-07-24

## 概要

本文書は、v3仕様の分析結果に基づく改善提案をまとめたものです。

## 1. 実装済み改善項目

### 1.1 メモリマップドI/O方式の採用

- **改善内容**: 全ユニットの操作を統一的なメモリインターフェースで実現
- **効果**:
  - アトミック性問題の解決
  - 拡張性の向上
  - COMPUTERを含む全ユニットの統一的操作

### 1.2 アドレッシングモード3方式

- **改善内容**: 相対・絶対・テンプレートの3つのアドレッシング方式
- **効果**:
  - 人間プログラマの利便性向上（絶対アドレス）
  - 進化耐性の確保（テンプレート）
  - 効率的なローカル変数管理（相対アドレス）

### 1.3 補完パターンマッチング

- **改善内容**: Tierraスタイルの補完パターンによるテンプレートマッチング
- **効果**:
  - 自己参照の防止
  - 進化による変異への耐性
  - 位置独立コードの実現

## 2. 優先度高の改善提案

### 2.1 物理演算の詳細仕様化

**問題**: 衝突・反発力の計算が曖昧

**提案**:

- オブジェクト形状: 円形を基本とする
- 反発力計算式: `F = k × overlap × (m1 × m2)/(m1 + m2)`
  - k: 反発係数（設定可能）
  - overlap: 重なり量
  - m1, m2: 各オブジェクトの質量
- 摩擦係数: 0.1（速度に比例した減衰）

### 2.2 エネルギーオブジェクトの物理仕様

**問題**: エネルギーの物理的振る舞いが未定義

**提案**:

- 単位サイズ: 1E = 1単位体積
- 結合ルール: 同一座標の複数エネルギーは自動的に結合
- 分割ルール: DISASSEMBLERによってのみ分割可能
- 慣性: 通常のゲームオブジェクトと同様（質量=エネルギー量）

### 2.3 回路接続の具体的仕様

**問題**: 物理的接続と回路的接続の区別が不明確

**提案**:

- 物理的接続: ユニット同士が固定された状態
- 回路的接続: 物理的接続 + 接続許可フラグ
- 接続上限: 各ユニット最大16接続
- 接続確立: 双方の同意が必要

## 3. 中優先度の改善提案

### 3.1 エネルギー確保・実行順序の決定

**提案**: 以下の優先順位で処理

1. エネルギー確保順序:
   - 生存必須アクション（修復、熱回避）
   - 生産アクション
   - 移動・その他
2. 実行順序:
   - 同一優先度内ではランダム

### 3.2 CONNECTORユニットの再評価

**分析**: 現仕様でも以下が可能

- 隣接状態での操作
- メモリマップドI/Oによる制御

**結論**: 現時点では不要。将来的に高度な捕食戦略が必要になった場合に再検討

### 3.3 HULLマージ時のID処理

**提案**:

- より大きい容量のHULLのIDを継承
- 同容量の場合は先にマージを宣言した側のIDを継承
- マージログを保持（デバッグ用）

## 4. 将来課題

### 4.1 環境多様性の追加

- 地形要素（障害物、流れ）
- エネルギー密度勾配
- 情報フィールド（フェロモン的機構）

### 4.2 突然変異メカニズムの拡張

- 環境放射線によるビット反転
- コピーエラー率の設定可能化
- エピジェネティック的変化

### 4.3 生態的ニッチの創出

- 異なる環境条件での特化
- 共生関係の促進メカニズム
- 資源の多様化

## 5. 実装推奨事項

### 5.1 デバッグ・可視化機能

- ユニット内部状態の可視化
- メモリ内容のリアルタイム表示
- エネルギーフローの可視化

### 5.2 パフォーマンス最適化

- 空間分割による衝突検出の高速化
- メモリアクセスパターンの最適化
- 並列処理の活用

### 5.3 バランス調整パラメータ

- エネルギーソース密度
- 熱拡散・放熱率
- ユニットコスト係数

## 6. まとめ

v3仕様は基本的な自己複製エージェントの実装に必要な機能を全て備えています。メモリマップドI/O方式の採用により、統一的で拡張性の高いシステムが実現されました。

残る課題の多くは実装詳細レベルのものであり、プロトタイプとしての機能は十分に達成されています。今後は実際の実装とプレイテストを通じて、バランス調整と追加機能の必要性を評価することが重要です。
