# エネルギーバランス検証

## このファイルについて

1024進法エネルギーシステムのバランス調整を検証し、ゲームプレイが成立することを確認する。

## 1. 16bit範囲検証

### 1024進法エネルギー表現の範囲

- **最大値**: 65,535 × 1024 + 1,023 = 67,108,863E
- **16bit直接表現**: 0 ～ 65,535E
- **上位16bitのみ**: 0 ～ 67,107,840E（1024E単位）

### 主要なエネルギー値の検証

#### ユニット生成コスト

| ユニット              | 構成エネルギー | 生産エネルギー | 合計     | 16bit範囲 | 1024進法表現  |
| --------------------- | -------------- | -------------- | -------- | --------- | ------------- |
| HULL(100)             | 200E           | 10E            | 210E     | ✓         | 0×1024 + 210  |
| HULL(1000)            | 2,000E         | 100E           | 2,100E   | ✓         | 2×1024 + 52   |
| HULL(10000)           | 20,000E        | 1,000E         | 21,000E  | ✓         | 20×1024 + 520 |
| ASSEMBLER(1)          | 1,000E         | 200E           | 1,200E   | ✓         | 1×1024 + 176  |
| ASSEMBLER(10)         | 2,800E         | 560E           | 3,360E   | ✓         | 3×1024 + 288  |
| DISASSEMBLER(10)      | 1,200E         | 240E           | 1,440E   | ✓         | 1×1024 + 416  |
| COMPUTER(1Hz,256B)    | 13,304E        | 1,331E         | 14,635E  | ✓         | 14×1024 + 299 |
| COMPUTER(10Hz,256B)   | 13,700E        | 1,370E         | 15,070E  | ✓         | 14×1024 + 734 |
| COMPUTER(100Hz,1024B) | 91,400E        | 9,140E         | 100,540E | ×         | 98×1024 + 188 |

**結論**: 通常のゲームプレイで使用される構成は16bit範囲内に収まる。極端な構成（100Hz COMPUTER等）は32bit演算が必要。

### 最小構成エージェント

- **合計コスト**: 16,045E = 15×1024 + 685
- **16bit範囲**: ✓（問題なし）
- **上位16bitのみで概算**: 15kE（十分な精度）

## 2. エネルギーソース産出量の提案

### 基本方針

- 最小構成エージェントが自己複製するのに必要な時間を基準に設定
- エネルギー収集と消費のバランスを考慮
- 複数のエージェントが競合する環境を想定

### エネルギーソース産出量案

#### 小規模ソース

- **産出量**: 10E/tick
- **用途**: 維持・小規模作業用
- **自己複製時間**: 約1,700tick（エネルギー収集のみ）

#### 中規模ソース

- **産出量**: 100E/tick
- **用途**: 成長・生産活動用
- **自己複製時間**: 約170tick（エネルギー収集のみ）

#### 大規模ソース

- **産出量**: 1,000E/tick
- **用途**: 大規模建設・競争環境用
- **自己複製時間**: 約17tick（エネルギー収集のみ）
- **競合**: 複数エージェントで奪い合い

### エネルギー密度の設定

```
セルあたりのエネルギー容量: 1,024E（1kE）
- 小規模ソース周辺: 100E程度
- 中規模ソース周辺: 500E程度
- 大規模ソース周辺: 1,024E（満杯）
```

## 3. アクションコストバランスの検証

### 基本アクション（1tick あたり）

#### COMPUTER動作

| 動作周波数   | 命令実行コスト | tick消費       | 効率性評価             |
| ------------ | -------------- | -------------- | ---------------------- |
| 1命令/tick   | 1～6E          | 1～6E/tick     | 基準                   |
| 10命令/tick  | 1～6E          | 10～60E/tick   | 高効率作業向け         |
| 100命令/tick | 1～6E          | 100～600E/tick | 超高速処理（コスト大） |

**バランス評価**: 動作周波数に比例したコストで、適切なトレードオフ

#### ASSEMBLER生産

| 生産対象      | 生産時間  | エネルギー消費  | 効率性   |
| ------------- | --------- | --------------- | -------- |
| HULL(20)      | 約10tick  | 42E + 作業E     | 拡張用   |
| HULL(100)     | 約50tick  | 210E + 作業E    | 基本構成 |
| COMPUTER(1Hz) | 約150tick | 14,635E + 作業E | 高コスト |

**バランス評価**: 高機能ユニットほど生産コストが高く、戦略的判断が必要

#### DISASSEMBLER分解

- **投入エネルギー**: 任意（最低1E）
- **成功確率**: 投入量とdisassemble_powerに依存
- **リスク**: 失敗時は全量が熱に変換

**バランス評価**: ギャンブル性があり、戦略的な使用が求められる

### 環境ダメージ

#### 熱ダメージ

| セル温度 | ダメージ/tick | 耐久時間（HULL 200E） |
| -------- | ------------- | --------------------- |
| 101度    | 1E            | 200tick               |
| 110度    | 10E           | 20tick                |
| 150度    | 50E           | 4tick                 |
| 200度    | 100E          | 2tick                 |

**バランス評価**: 高温環境は致命的だが、短時間なら耐えられる

## 4. ゲームプレイシナリオ検証

### シナリオ1: 単独エージェントの成長

1. **初期状態**: 最小構成エージェント（16,045E相当）
2. **エネルギー収集**: 中規模ソース（100E/tick）
3. **成長フェーズ**: HULLを200まで拡張（約20tick）
4. **複製準備**: エネルギー蓄積（約170tick）
5. **自己複製**: 娘個体生成（約50tick）
6. **合計時間**: 約240tick

**評価**: 適切なペースで進行

### シナリオ2: 競争環境

1. **複数エージェント**: 大規模ソース（1,000E/tick）を奪い合い
2. **戦略分岐**:
   - 高速複製戦略: 最小構成で量産
   - 高性能戦略: 高周波COMPUTER搭載
   - 妨害戦略: DISASSEMBLER活用
3. **熱管理**: エネルギー消費による発熱で環境制御

**評価**: 多様な戦略が可能

### シナリオ3: 資源枯渇環境

1. **小規模ソースのみ**: 10E/tick
2. **省エネ運用**: 低周波COMPUTER（0.3Hz）
3. **効率的拡張**: 最小限のユニット構成
4. **長期戦**: 1,700tick以上かけて複製

**評価**: 厳しいが不可能ではない

## 5. バランス調整の推奨事項

### 調整が必要な項目

1. **エネルギーソースの初期配置**
   - マップサイズに応じた密度設定
   - 種類の比率（小:中:大 = 10:3:1 等）

2. **熱拡散パラメータ**
   - 現在未定義のため、適切な値の設定が必要
   - 推奨: 隣接セルへ10%/tick程度

3. **ASSEMBLER生産速度**
   - assemble_powerの詳細な効果を定義
   - 推奨: power × 2E/tick の生産速度

4. **DISASSEMBLER成功率**
   - 詳細な計算式の定義が必要
   - 推奨: min(投入E / (対象の構成E × 0.1), 0.5)

### 将来的な拡張への配慮

1. **新ユニットタイプ追加時**
   - 16bit範囲内でのコスト設計
   - 既存ユニットとのバランス考慮

2. **マップサイズ拡大時**
   - エネルギーソース密度の調整
   - 移動コストの実装検討

3. **マルチプレイヤー対応時**
   - プレイヤー間のバランス調整機構
   - エネルギー総量の管理

## 6. 結論

### 検証結果

- ✓ 最小構成エージェントは16bit範囲内で問題なく扱える
- ✓ 1024進法により、大規模な値も効率的に表現可能
- ✓ 各種アクションのコストバランスは適切
- ✓ 多様なゲームプレイが可能

### 残課題

- エネルギーソース産出量の実装と調整
- 熱拡散システムの詳細定義
- 一部の計算式の詳細化

現在のエネルギーシステムは、ゲームバランスの観点から適切に設計されており、実装に移行可能な状態にある。
